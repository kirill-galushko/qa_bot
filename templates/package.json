{
  "title": "Здравствуйте, что вас интересует?",
  "type": "object",
  "properties": {
    "Приветствие и запрос имени бота": {
      "nodeId": 0,
      "title": "Приветствие и запрос имени бота",
      "clear": [],
      "buttons": [],
      "ways": [
        {
          "title": "Переход к вопросу о имени бота",
          "nextNodeId": 1,
          "failNodeId": 0,
          "match": {
            "function": "DefaultMatcher",
            "args": []
          },
          "action": {
            "function": "DefaultAction",
            "args": []
          },
          "messageText": "Здравствуйте, я помогу вам зарегистрировать бота, который может выполнять любые действия, в зависимости от того, как вы его настроите! Для начала, создайте бота с помощью сервиса BotFather и введите его имя."
        }
      ],
      "defaultBehavior": {
        "message": "Извините, не удалось обработать ваш запрос. Пожалуйста, повторите ввод имени бота"
      }
    },
    "Сохранение имени бота и запрос его ключа": {
      "nodeId": 1,
      "title": "Сохранение имени бота и запрос его ключа",
      "clear": [],
      "buttons": [],
      "ways": [
        {
          "title": "Переход к вопросу о ключе бота",
          "nextNodeId": 2,
          "failNodeId": 1,
          "contextField": "botName",
          "match": {
            "function": "DefaultMatcher",
            "args": []
          },
          "action": {
            "function": "CheckTelegramBotNameAction",
            "args": []
          },
          "messageText": "Введите ключ доступа бота, сгенерированный в BotFather"
        }
      ],
      "defaultBehavior": {
        "message": "Извините, не удалось обработать ваш запрос. Пожалуйста, повторите ввод ключа доступа бота"
      }
    },
    "Сохранение ключа и предложение привязать CRM систему": {
      "nodeId": 2,
      "title": "Сохранение ключа и предложение привязать CRM систему",
      "clear": [],
      "buttons": [],
      "ways": [
        {
          "title": "регистрация бота и предложение привязать CRM",
          "nextNodeId": 3,
          "failNodeId": 1,
          "contextField": "botKey",
          "buttons": [
            "Да",
            "Нет"
          ],
          "match": {
            "function": "DefaultMatcher",
            "args": []
          },
          "action": {
            "function": "RegisterTelegramBotAction",
            "args": []
          },
          "messageText": ""
        }
      ]
    },
    "Обработка согласия/отказа привязки CRM": {
      "nodeId": 3,
      "title": "Обработка согласия/отказа привязки CRM",
      "clear": [],
      "buttons": [],
      "ways": [
        {
          "title": "Запрос типа CRM системы",
          "nextNodeId": 4,
          "failNodeId": 3,
          "buttons": [
            "Vtiger",
            "Ни одна не подходит"
          ],
          "match": {
            "function": "RegexMatcher",
            "args": [
              "/Да/"
            ]
          },
          "action": {
            "function": "DefaultAction",
            "args": []
          },
          "messageText": "Выберите тип CRM системы"
        },
        {
          "title": "Запрос типа CRM системы",
          "nextNodeId": 5,
          "failNodeId": 3,
          "buttons": [],
          "match": {
            "function": "RegexMatcher",
            "args": [
              "/Нет/"
            ]
          },
          "action": {
            "function": "DefaultAction",
            "args": []
          },
          "messageText": "Если вам потребуется эта возможность, вы всегда можете привязать CRM в личном кабинете сервиса. Для регистрации нового бота введите new"
        }
      ]
    },
    "Начало привязки CRM к боту": {
      "nodeId": 4,
      "title": "Начало привязки CRM к боту",
      "clear": [],
      "buttons": [],
      "ways": [
        {
          "title": "Запрос логина CRM",
          "nextNodeId": 6,
          "failNodeId": 4,
          "contextField": "crmType",
          "match": {
            "function": "RegexMatcher",
            "args": [
              "/Vtiger/"
            ]
          },
          "action": {
            "function": "DefaultAction",
            "args": []
          },
          "messageText": "Введите логин CRM"
        },
        {
          "title": "Переход к созданию нового бота",
          "nextNodeId": 5,
          "failNodeId": 4,
          "match": {
            "function": "DefaultMatcher",
            "args": []
          },
          "action": {
            "function": "DefaultAction",
            "args": []
          },
          "messageText": "Очень жаль, что нет вышей CRM. В таком случае бот будет использовать встроенную в сервис CRM систему. Для создания нового бота введите new"
        }
      ]
    },
    "Инициализация регистрации еще одного бота": {
      "nodeId": 5,
      "title": "Инициализация регистрации еще одного бота",
      "clear": [
        "botKey",
        "botName"
      ],
      "buttons": [],
      "ways": [
        {
          "title": "Переход к вопросу о имени бота",
          "nextNodeId": 1,
          "failNodeId": 5,
          "match": {
            "function": "RegexMatcher",
            "args": [
              "/new/"
            ]
          },
          "action": {
            "function": "DefaultAction",
            "args": []
          },
          "messageText": "Введите имя бота"
        }
      ],
      "defaultBehavior": {
        "message": "Для регистрации нового бота введите new"
      }
    },
    "Сохранение логина и запрос пароля CRM": {
      "nodeId": 6,
      "title": "Сохранение логина и запрос пароля CRM",
      "clear": [],
      "buttons": [],
      "ways": [
        {
          "title": "",
          "nextNodeId": 7,
          "failNodeId": 6,
          "contextField": "crmLogin",
          "match": {
            "function": "DefaultMatcher",
            "args": []
          },
          "action": {
            "function": "DefaultAction",
            "args": []
          },
          "messageText": "Введите пароль CRM системы!"
        }
      ]
    },
    "Сохранение пароля и запрос URL CRM": {
      "nodeId": 7,
      "title": "Сохранение пароля и запрос URL CRM",
      "clear": [],
      "buttons": [],
      "ways": [
        {
          "title": "",
          "nextNodeId": 8,
          "failNodeId": 7,
          "contextField": "crmPassword",
          "match": {
            "function": "DefaultMatcher",
            "args": []
          },
          "action": {
            "function": "DefaultAction",
            "args": []
          },
          "messageText": "Введите url CRM системы!"
        }
      ]
    },
    "Сохранение URL и регистрация CRM": {
      "nodeId": 8,
      "title": "Сохранение URL и регистрация CRM",
      "clear": [],
      "buttons": [],
      "ways": [
        {
          "title": "",
          "nextNodeId": 5,
          "failNodeId": 8,
          "contextField": "crmURL",
          "match": {
            "function": "DefaultMatcher",
            "args": []
          },
          "action": {
            "function": "RegisterCrmAction",
            "args": []
          },
          "messageText": "Ваша CRM система была привязана к боту. Вы можете изменить настройки в личном кабинете сервиса! Для создания новго бота введите new"
        }
      ]
    }
  }
}
